{
  
    
        "post0": {
            "title": "How to use logging to debug",
            "content": ". Why use logging instead of print()? . Logging gives you the flexibility to . turn on and off the debugging message | recording logging events in a file | . The flexibility is especially helpful when you&#39;re running a large program with multiple scripts. . . Basic Usage . There are five standard logging levels (in increasing order of severity) . DEBUG | INFO | WARNING | ERROR | CRITICAL | . The logging levels are used as thresholds for tracking. Once the logging level is set, messages with lower levels won&#39;t be printed. . . We can use basicConfig to initiate a root logger with a severity level: . import logging logging.basicConfig(level=logging.INFO) . The logging functions are named after the levels. The default message is in this format: . {logging level} : {logger name} {message} . logging.debug(&#39;debug message&#39;) # will not print anything logging.info(&#39;info message&#39;) # will print a message to the console logging.warning(&#39;warning message&#39;) logging.error(&#39;error message&#39;) logging.critical(&#39;critical message&#39;) . INFO:root:info message WARNING:root:warning message ERROR:root:error message CRITICAL:root:critical message . Since we set the level to INFO, messages with level lower than INFO won&#39;t be printed . . Important: The logging level of the root logger can only be set once. If you&#8217;d like to reset the logging level, you have to restart your runtime. . . Display date and time in logging messages . We can specify the format argument to change the format of displayed messges. . import logging logging.basicConfig(format=&#39;%(asctime)s - %(name)s - %(levelname)s - %(message)s&#39;) logging.warning(&#39;is when this event was logged.&#39;) . . Logging to a file . To log to a file, we can specify the filename argument in basicConfig . import logging logging.basicConfig(filename=&#39;example.log&#39;, level=logging.INFO) logging.debug(&#39;debug message&#39;) # will not print anything logging.info(&#39;info message&#39;) # will print a message to the console logging.warning(&#39;warning message&#39;) logging.error(&#39;error message&#39;) logging.critical(&#39;critical message&#39;) . The example.log file should have the following messages: . INFO:root:info message WARNING:root:warning message ERROR:root:error message CRITICAL:root:critical message . . Not remembering the messages from earlier runs . If we run the above code several times, the messages from successive runs will be appended to example.log. . If we want each run to start afresh, we can specify the filemode argument: . import logging logging.basicConfig(filename=&#39;example.log&#39;, filemode=&#39;w&#39;, level=logging.INFO) logging.debug(&#39;debug message&#39;) # will not print anything logging.info(&#39;info message&#39;) # will print a message to the console logging.warning(&#39;warning message&#39;) logging.error(&#39;error message&#39;) logging.critical(&#39;critical message&#39;) . . Logging from multiple modules . If our program consists of multiple modules, we can create a logger in each module with: . logger = logging.getLogger(__name__) . and use logger.debug(), logger.info(), logger.warning(), logger.error(), or logger.critical() for logging messages. . Example . # mylib1.py import logging # create logger with name &#39;mylib1&#39; logger = logging.getLogger(__name__) def do_something_1(): logger.info(&#39;Doing something&#39;) . # mylib2.py import logging # create logger with name &#39;mylib1&#39; logger = logging.getLogger(__name__) def do_something_2(): logger.info(&#39;Doing something&#39;) . import logging import mylib1, mylib2 def main(): logging.basicConfig(level=logging.INFO) logging.info(&#39;Started&#39;) mylib1.do_something_1() mylib2.do_something_2() logging.info(&#39;Finished&#39;) if __name__ == &#39;__main__&#39;: main() . INFO:root:Started INFO:mylib1:Doing something INFO:mylib2:Doing something INFO:root:Finished . By creating a logger in each module and setting a logger name, we can tell from the logging messages where in our application the messages came from. . . Setting the logging level from a command-line option . If you want to set the logging level from a command-line option such as: . --log INFO . Here&#39;s an example script: . #logger.py import argparse import logging parser = argparse.ArgumentParser( description=&#39;Process logging level&#39;) parser.add_argument(&#39;--log&#39;, default=&#39;DEBUG&#39;, help=&#39;set logging level&#39;) args = parser.parse_args() print(args) # get log level loglevel = getattr(logging, args.log.upper()) logging.basicConfig(filename = &#39;file.log&#39;,level=loglevel,filemode=&#39;w&#39; ) logging.info(&#39;test message 1&#39;) logging.debug(&#39;test message 2&#39;) . %run logger.py --log INFO . Namespace(log=&#39;INFO&#39;) . You should find the following message in file.log: . INFO:root:test message 1 . . . Reference . logging official doc | official logging howto | argparse official doc | .",
            "url": "https://www.intodeeplearning.com/how-to-use-logging-to-debug/",
            "relUrl": "/how-to-use-logging-to-debug/",
            "date": " • Jun 23, 2022"
        }
        
    
  
    
        ,"post1": {
            "title": "Multiclass text classification using BERT",
            "content": "In this post, we&#39;ll do a simple text classification task using the pretained BERT model from HuggingFace. . The BERT model was proposed in BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding, by Jacob Devlin, Ming-Wei Chang, Kenton Lee and Kristina Toutanova. . Loading data . We&#39;ll use the emotion dataset from the Hugging Face Hub. . from datasets import load_dataset emotion = load_dataset(&#39;emotion&#39;) . Using custom data configuration default . Downloading and preparing dataset emotion/default (download: 1.97 MiB, generated: 2.07 MiB, post-processed: Unknown size, total: 4.05 MiB) to /root/.cache/huggingface/datasets/emotion/default/0.0.0/348f63ca8e27b3713b6c04d723efe6d824a56fb3d1449794716c0f0296072705... Dataset emotion downloaded and prepared to /root/.cache/huggingface/datasets/emotion/default/0.0.0/348f63ca8e27b3713b6c04d723efe6d824a56fb3d1449794716c0f0296072705. Subsequent calls will reuse this data. . . The emotion dataset consists of three sets: train, validation, and test set, and has six kinds of emotion: sadness, joy, love, anger, fear, and surprise. . emotion . DatasetDict({ train: Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 16000 }) validation: Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 2000 }) test: Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 2000 }) }) . label_names = emotion[&quot;train&quot;].features[&#39;label&#39;].names label_names . [&#39;sadness&#39;, &#39;joy&#39;, &#39;love&#39;, &#39;anger&#39;, &#39;fear&#39;, &#39;surprise&#39;] . Let&#39;s take a look at what the text is like: . emotion.set_format(type=&quot;pandas&quot;) train_df = emotion[&#39;train&#39;][:] valid_df = emotion[&#39;validation&#39;][:] test_df = emotion[&#39;test&#39;][:] . train_df.head() . text label . 0 i didnt feel humiliated | 0 | . 1 i can go from feeling so hopeless to so damned... | 0 | . 2 im grabbing a minute to post i feel greedy wrong | 3 | . 3 i am ever feeling nostalgic about the fireplac... | 2 | . 4 i am feeling grouchy | 3 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt; In this post, we&#39;ll just use 350 samples from each class for training, and 70 samples for validation and 50 for testing. . train_df = train_df.groupby(&#39;label&#39;).apply(lambda x: x.sample(350)).reset_index(drop=True) valid_df = valid_df.groupby(&#39;label&#39;).apply(lambda x: x.sample(70)).reset_index(drop=True) test_df = test_df.groupby(&#39;label&#39;).apply(lambda x: x.sample(50)).reset_index(drop=True) . train_df[&#39;label&#39;].value_counts() . 0 350 1 350 2 350 3 350 4 350 5 350 Name: label, dtype: int64 . valid_df[&#39;label&#39;].value_counts() . 0 70 1 70 2 70 3 70 4 70 5 70 Name: label, dtype: int64 . test_df[&#39;label&#39;].value_counts() . 0 50 1 50 2 50 3 50 4 50 5 50 Name: label, dtype: int64 . . Tokenization . Tokenization is a process for spliting raw texts into tokens, and encoding the tokens into numeric data. . To do this, we first initialize a BertTokenizer: . from transformers import BertTokenizer PRETRAINED_LM = &quot;bert-base-uncased&quot; tokenizer = BertTokenizer.from_pretrained(PRETRAINED_LM, do_lower_case=True) tokenizer . PreTrainedTokenizer(name_or_path=&#39;bert-base-uncased&#39;, vocab_size=30522, model_max_len=512, is_fast=False, padding_side=&#39;right&#39;, truncation_side=&#39;right&#39;, special_tokens={&#39;unk_token&#39;: &#39;[UNK]&#39;, &#39;sep_token&#39;: &#39;[SEP]&#39;, &#39;pad_token&#39;: &#39;[PAD]&#39;, &#39;cls_token&#39;: &#39;[CLS]&#39;, &#39;mask_token&#39;: &#39;[MASK]&#39;}) . define a function for encoding: . def encode(docs): &#39;&#39;&#39; This function takes list of texts and returns input_ids and attention_mask of texts &#39;&#39;&#39; encoded_dict = tokenizer.batch_encode_plus(docs, add_special_tokens=True, max_length=128, padding=&#39;max_length&#39;, return_attention_mask=True, truncation=True, return_tensors=&#39;pt&#39;) input_ids = encoded_dict[&#39;input_ids&#39;] attention_masks = encoded_dict[&#39;attention_mask&#39;] return input_ids, attention_masks . Use the ecode function to get input ids and attention masks of the datasets: . train_input_ids, train_att_masks = encode(train_df[&#39;text&#39;].values.tolist()) valid_input_ids, valid_att_masks = encode(valid_df[&#39;text&#39;].values.tolist()) test_input_ids, test_att_masks = encode(test_df[&#39;text&#39;].values.tolist()) . . Creating Datasets and DataLoaders . We&#39;ll use pytorch Dataset and DataLoader to split data into batches. For more detatils, you can check out another post on DataLoader. . Turn the labels into tensors: . import torch train_y = torch.LongTensor(train_df[&#39;label&#39;].values.tolist()) valid_y = torch.LongTensor(valid_df[&#39;label&#39;].values.tolist()) test_y = torch.LongTensor(test_df[&#39;label&#39;].values.tolist()) train_y.size(),valid_y.size(),test_y.size() . (torch.Size([2100]), torch.Size([420]), torch.Size([300])) . Create dataloaders for training . from torch.utils.data import TensorDataset, DataLoader, RandomSampler, SequentialSampler BATCH_SIZE = 16 train_dataset = TensorDataset(train_input_ids, train_att_masks, train_y) train_sampler = RandomSampler(train_dataset) train_dataloader = DataLoader(train_dataset, sampler=train_sampler, batch_size=BATCH_SIZE) valid_dataset = TensorDataset(valid_input_ids, valid_att_masks, valid_y) valid_sampler = SequentialSampler(valid_dataset) valid_dataloader = DataLoader(valid_dataset, sampler=valid_sampler, batch_size=BATCH_SIZE) test_dataset = TensorDataset(test_input_ids, test_att_masks, test_y) test_sampler = SequentialSampler(test_dataset) test_dataloader = DataLoader(test_dataset, sampler=test_sampler, batch_size=BATCH_SIZE) . . Bert For Sequence Classification Model . We will initiate the BertForSequenceClassification model from Huggingface, which allows easily fine-tuning the pretrained BERT mode for classification task. . You will see a warning that some parts of the model are randomly initialized. This is normal since the classification head has not yet been trained. . from transformers import BertForSequenceClassification N_labels = len(train_df.label.unique()) model = BertForSequenceClassification.from_pretrained(PRETRAINED_LM, num_labels=N_labels, output_attentions=False, output_hidden_states=False) . Some weights of the model checkpoint at bert-base-uncased were not used when initializing BertForSequenceClassification: [&#39;cls.seq_relationship.weight&#39;, &#39;cls.predictions.transform.dense.weight&#39;, &#39;cls.seq_relationship.bias&#39;, &#39;cls.predictions.transform.LayerNorm.bias&#39;, &#39;cls.predictions.decoder.weight&#39;, &#39;cls.predictions.transform.dense.bias&#39;, &#39;cls.predictions.bias&#39;, &#39;cls.predictions.transform.LayerNorm.weight&#39;] - This IS expected if you are initializing BertForSequenceClassification from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model). - This IS NOT expected if you are initializing BertForSequenceClassification from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model). Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: [&#39;classifier.weight&#39;, &#39;classifier.bias&#39;] You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference. . device = torch.device(&quot;cuda&quot; if torch.cuda.is_available() else &quot;cpu&quot;) device . device(type=&#39;cuda&#39;) . model = model.cuda() . . Fine-tuning . Optimizer and Scheduler . An optimizer is for tuning parameters in the model, which is set up with a learning rate. . Selection of the learning rate is important. In practice, it&#39;s common to use a scheduler to decrease the learning rate during training. . from torch.optim import AdamW from transformers import get_linear_schedule_with_warmup EPOCHS = 30 LEARNING_RATE = 2e-6 optimizer = AdamW(model.parameters(), lr=LEARNING_RATE) scheduler = get_linear_schedule_with_warmup(optimizer, num_warmup_steps=0, num_training_steps=len(train_dataloader)*EPOCHS ) . . Training Loop . The training loop is where the magic of deep learning happens. The model will be fine-tuned on the emotion dataset for classification task. . from torch.nn.utils import clip_grad_norm_ from tqdm.notebook import tqdm import numpy as np import math train_loss_per_epoch = [] val_loss_per_epoch = [] for epoch_num in range(EPOCHS): print(&#39;Epoch: &#39;, epoch_num + 1) &#39;&#39;&#39; Training &#39;&#39;&#39; model.train() train_loss = 0 for step_num, batch_data in enumerate(tqdm(train_dataloader,desc=&#39;Training&#39;)): input_ids, att_mask, labels = [data.to(device) for data in batch_data] output = model(input_ids = input_ids, attention_mask=att_mask, labels= labels) loss = output.loss train_loss += loss.item() model.zero_grad() loss.backward() del loss clip_grad_norm_(parameters=model.parameters(), max_norm=1.0) optimizer.step() scheduler.step() train_loss_per_epoch.append(train_loss / (step_num + 1)) &#39;&#39;&#39; Validation &#39;&#39;&#39; model.eval() valid_loss = 0 valid_pred = [] with torch.no_grad(): for step_num_e, batch_data in enumerate(tqdm(valid_dataloader,desc=&#39;Validation&#39;)): input_ids, att_mask, labels = [data.to(device) for data in batch_data] output = model(input_ids = input_ids, attention_mask=att_mask, labels= labels) loss = output.loss valid_loss += loss.item() valid_pred.append(np.argmax(output.logits.cpu().detach().numpy(),axis=-1)) val_loss_per_epoch.append(valid_loss / (step_num_e + 1)) valid_pred = np.concatenate(valid_pred) &#39;&#39;&#39; Loss message &#39;&#39;&#39; print(&quot;{0}/{1} train loss: {2} &quot;.format(step_num+1, math.ceil(len(train_df) / BATCH_SIZE), train_loss / (step_num + 1))) print(&quot;{0}/{1} val loss: {2} &quot;.format(step_num_e+1, math.ceil(len(valid_df) / BATCH_SIZE), valid_loss / (step_num_e + 1))) . Epoch: 1 132/132 train loss: 1.8044047635613065 27/27 val loss: 1.7784268856048584 Epoch: 2 132/132 train loss: 1.7764473376852092 27/27 val loss: 1.7467590747056183 Epoch: 3 132/132 train loss: 1.7184552062641492 27/27 val loss: 1.6817542844348483 Epoch: 4 132/132 train loss: 1.6414188760699648 27/27 val loss: 1.5867101660481207 Epoch: 5 132/132 train loss: 1.5393207082242677 27/27 val loss: 1.486947735150655 Epoch: 6 132/132 train loss: 1.4170215689774714 27/27 val loss: 1.3694858639328569 Epoch: 7 132/132 train loss: 1.294279702685096 27/27 val loss: 1.257334996152807 Epoch: 8 132/132 train loss: 1.1829162167780327 27/27 val loss: 1.1601881892592818 Epoch: 9 132/132 train loss: 1.0817181079676657 27/27 val loss: 1.0763609210650127 Epoch: 10 132/132 train loss: 0.9864328092697895 27/27 val loss: 1.014382865693834 Epoch: 11 132/132 train loss: 0.9053400375626304 27/27 val loss: 0.9448991947703891 Epoch: 12 132/132 train loss: 0.829155604947697 27/27 val loss: 0.8941110240088569 Epoch: 13 132/132 train loss: 0.7659972933205691 27/27 val loss: 0.838810454916071 Epoch: 14 132/132 train loss: 0.7028251493519003 27/27 val loss: 0.8023700261557544 Epoch: 15 132/132 train loss: 0.6520604859247352 27/27 val loss: 0.758354742217947 Epoch: 16 132/132 train loss: 0.6056500298507286 27/27 val loss: 0.7294005663306625 Epoch: 17 132/132 train loss: 0.5692454813556238 27/27 val loss: 0.6919559869501326 Epoch: 18 132/132 train loss: 0.5237459628419443 27/27 val loss: 0.6667491247256597 Epoch: 19 132/132 train loss: 0.49814519399043283 27/27 val loss: 0.6523853794292167 Epoch: 20 132/132 train loss: 0.4644078386552406 27/27 val loss: 0.6313007291820314 Epoch: 21 132/132 train loss: 0.4391077608998978 27/27 val loss: 0.6154146304836979 Epoch: 22 132/132 train loss: 0.4171938304648255 27/27 val loss: 0.6058549671261398 Epoch: 23 132/132 train loss: 0.4054019095545465 27/27 val loss: 0.5962215772381535 Epoch: 24 132/132 train loss: 0.3896281441504305 27/27 val loss: 0.5836309084185848 Epoch: 25 132/132 train loss: 0.3799004386546034 27/27 val loss: 0.5790578303513704 Epoch: 26 132/132 train loss: 0.3660807737121076 27/27 val loss: 0.5728193725700732 Epoch: 27 132/132 train loss: 0.3604669314668034 27/27 val loss: 0.5727653321292665 Epoch: 28 132/132 train loss: 0.3513458561942433 27/27 val loss: 0.5694188663253078 Epoch: 29 132/132 train loss: 0.3464061285961758 27/27 val loss: 0.5668780207633972 Epoch: 30 132/132 train loss: 0.345695345464981 27/27 val loss: 0.5667423147846151 . . You can see in the output that the training and validation losses steadily decreases in each epoch. . from matplotlib import pyplot as plt epochs = range(1, EPOCHS +1 ) fig, ax = plt.subplots() ax.plot(epochs,train_loss_per_epoch,label =&#39;training loss&#39;) ax.plot(epochs, val_loss_per_epoch, label = &#39;validation loss&#39; ) ax.set_title(&#39;Training and Validation loss&#39;) ax.set_xlabel(&#39;Epochs&#39;) ax.set_ylabel(&#39;Loss&#39;) ax.legend() plt.show() . Performance Metrics . It&#39;s common to use precision, recall, and F1-score as the performance metrics. . from sklearn.metrics import classification_report print(&#39;classifiation report&#39;) print(classification_report(valid_pred, valid_df[&#39;label&#39;].to_numpy(), target_names=label_names)) . classifiation report precision recall f1-score support 0 0.70 0.80 0.75 61 1 0.79 0.87 0.83 63 2 0.77 0.82 0.79 66 3 0.83 0.72 0.77 80 4 0.80 0.73 0.76 77 5 0.93 0.89 0.91 73 accuracy 0.80 420 macro avg 0.80 0.81 0.80 420 weighted avg 0.81 0.80 0.80 420 . Error Analysis . With the predictions, we can plot the confusion matrix: . from sklearn.metrics import ConfusionMatrixDisplay, confusion_matrix def plot_confusion_matrix(y_preds, y_true, labels=None): cm = confusion_matrix(y_true, y_preds, normalize=&quot;true&quot;) fig, ax = plt.subplots(figsize=(6, 6)) disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=labels) disp.plot(cmap=&quot;Blues&quot;, values_format=&quot;.2f&quot;, ax=ax, colorbar=False) plt.title(&quot;Normalized confusion matrix&quot;) plt.show() . plot_confusion_matrix(valid_pred,valid_df[&#39;label&#39;].to_numpy(),labels=label_names) . You can see that sadness has a higher likelihood to be classified as anger or fear, leading to a lower f1 score. . . Prediction . Now let&#39;s use the trained model to predict the testing set. . model.eval() test_pred = [] test_loss= 0 with torch.no_grad(): for step_num, batch_data in tqdm(enumerate(test_dataloader)): input_ids, att_mask, labels = [data.to(device) for data in batch_data] output = model(input_ids = input_ids, attention_mask=att_mask, labels= labels) loss = output.loss test_loss += loss.item() test_pred.append(np.argmax(output.logits.cpu().detach().numpy(),axis=-1)) test_pred = np.concatenate(test_pred) . print(&#39;classifiation report&#39;) print(classification_report(test_pred, test_df[&#39;label&#39;].to_numpy(),target_names=label_names)) . classifiation report precision recall f1-score support 0 0.80 0.75 0.78 53 1 0.82 0.82 0.82 50 2 0.80 0.80 0.80 50 3 0.80 0.80 0.80 50 4 0.76 0.84 0.80 45 5 0.92 0.88 0.90 52 accuracy 0.82 300 macro avg 0.82 0.82 0.82 300 weighted avg 0.82 0.82 0.82 300 . With the predictions, we can plot the confusion matrix again: . plot_confusion_matrix(test_pred,test_df[&#39;label&#39;].to_numpy(),labels=label_names) . Output the misclassified text: . test_df[&#39;pred&#39;] = test_pred test_df.reset_index(level=0) print(test_df[test_df[&#39;label&#39;]!=test_df[&#39;pred&#39;]].shape) test_df[test_df[&#39;label&#39;]!=test_df[&#39;pred&#39;]][[&#39;text&#39;,&#39;label&#39;,&#39;pred&#39;]].head(10) . (55, 3) . text label pred . 6 i think im making up for feeling like i missed... | 0 | 2 | . 7 im not sure the feeling of loss will ever go a... | 0 | 2 | . 9 im afraid to call the guy from yesterday becau... | 0 | 3 | . 14 i feel like that im hated by most of the girls... | 0 | 3 | . 16 i wake up feeling like something terrifyingly ... | 0 | 4 | . 24 i had that kinda feeling but ignored it | 0 | 3 | . 26 i am again not inspired and after looking at i... | 0 | 1 | . 35 i do feel stressed | 0 | 3 | . 37 i feel much more energized than on a gloomy ra... | 0 | 1 | . 43 i cant feel dont turn your back on me i wont b... | 0 | 3 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt;",
            "url": "https://www.intodeeplearning.com/bert-multiclass-text-classification/",
            "relUrl": "/bert-multiclass-text-classification/",
            "date": " • Jun 16, 2022"
        }
        
    
  
    
        ,"post2": {
            "title": "Use tqdm to monitor model training progress",
            "content": ". When we&#39;re training a deep learning model, it helps to have a small progress bar giving us an estimation of how long the process would take to complete. To achieve this, we can use the Python external library tqdm. In this post, we will use tqdm to show a progress bar as we are loading data in the training loop. . . Installation . You can install the tqdm package by . pip3 install tqdm . . . Important: This post is created in Jupyter Notebook. Some progress bars in this post will only SHOW if you&#8217;re running in Jupyter Notebook. If you&#8217;d like to follow along with this post, you can click Open in Colab and run the following codes. . . Basic Usage . Installation . You can install the tqdm package by . pip3 install tqdm . How to import a tqdm object . use from tqdm import tqdm if you&#39;re using a terminal . | use from tqdm.notebook import tqdm if you&#39;re using a Jupyter Notebook . | . Commonly used parameters in a tqdm object . total : the total number of expected iterations if not specified already or needs modification, ex: 300 . | desc : description of your progress bar, ex: &quot;My Progress Bar&quot; . | disable: set this to True if you want to disable the progress bar . | . Syntax . tqdm(iterable, total= 100, desc=&quot;Text you want&quot;, disable = False) . . Example 1 . from tqdm.notebook import tqdm for i in tqdm(range(int(10e6)),desc= &quot;My Progress Bar&quot;): pass . . Use tqdm to keep track of batches in DataLoader . Step 1. Initiating a DataLoader . We will create a DataLoader with the training data of agnews dataset. . from datasets import load_dataset agnews = load_dataset(&#39;ag_news&#39;) train_dataset = agnews[&#39;train&#39;] . Using custom data configuration default . Downloading and preparing dataset ag_news/default (download: 29.88 MiB, generated: 30.23 MiB, post-processed: Unknown size, total: 60.10 MiB) to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548... Dataset ag_news downloaded and prepared to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548. Subsequent calls will reuse this data. . The dataset has two data fields, text and label. . train_dataset . Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 120000 }) . Now, we can initiate a DataLoader with the agnews training data . from torch.utils.data import DataLoader train_dataloader = DataLoader(train_dataset,batch_size=64) . If you need more detailed information about loading datasets and using DataLoader, you can check . How to load datasets from Hugging Face Datasets | How to use pytorch DataLoader | . . Step 2: Using tqdm to add a progress bar while loading data . from tqdm.notebook import tqdm for batch_index, data in tqdm(enumerate(train_dataloader), total=len(train_dataloader), desc =&quot;My Progress Bar&quot;): text = data[&#39;text&#39;] label = data[&#39;label&#39;] # print batch information every 700 batches if batch_index % 700 == 0: print(f&#39; nBatch {batch_index} n firs text: {text[0]}, n first label: {label[0]}&#39;) . Batch 0 firs text: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again., first label: 2 Batch 700 firs text: Sweden to Return Remains of Aborigines (AP) AP - The skeletal remains of 15 Aborigines are being returned home for reburial, nearly 90 years after a Swedish zoologist smuggled them out of Australia for display in a Stockholm museum., first label: 3 Batch 1400 firs text: Kashmiris waiting for festival and peace to come SRINAGAR, Nov. 13 (XinhuaNET) -- Markets are overcrowded, traffic jam is heavy and the shops are jostling with shoppers in the capital city of Srinagar in the Indian-administered Kashmir as theholy Moslem festival of Eid approaches here., first label: 0 . . Issues: tqdm printing to new line in Jupyter notebook . Case 1: import from tqdm in a Jupyter Notebook . Below is what will happen if we use from tqdm import tqdm instead of from tqdm.notebook import tqdm in italicized text Jupyter notebook. . from tqdm import tqdm for batch_index, data in tqdm(enumerate(train_dataloader), total=len(train_dataloader), desc =&quot;My Progress Bar&quot;): text = data[&#39;text&#39;] label = data[&#39;label&#39;] # print batch information every 700 batches if batch_index % 700 == 0: print(f&#39; nBatch {batch_index} n firs text: {text[0]}, n first label: {label[0]}&#39;) . My Progress Bar: 1%|▏ | 27/1875 [00:00&lt;00:06, 269.76it/s] . Batch 0 firs text: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again., first label: 2 . My Progress Bar: 39%|███▉ | 730/1875 [00:03&lt;00:04, 236.05it/s] . Batch 700 firs text: Sweden to Return Remains of Aborigines (AP) AP - The skeletal remains of 15 Aborigines are being returned home for reburial, nearly 90 years after a Swedish zoologist smuggled them out of Australia for display in a Stockholm museum., first label: 3 . My Progress Bar: 77%|███████▋ | 1442/1875 [00:05&lt;00:01, 241.85it/s] . Batch 1400 firs text: Kashmiris waiting for festival and peace to come SRINAGAR, Nov. 13 (XinhuaNET) -- Markets are overcrowded, traffic jam is heavy and the shops are jostling with shoppers in the capital city of Srinagar in the Indian-administered Kashmir as theholy Moslem festival of Eid approaches here., first label: 0 . My Progress Bar: 100%|██████████| 1875/1875 [00:07&lt;00:00, 238.31it/s] . . You can see that if you print something within the for loop, the progress bar will show on a new line in each iteration. . . Case 2: running a python script importing tqdm in Jupyter Notebook . If you are using some gpu cloud platforms, such as Colab, you may have to run your python script in Jupyter notebook. . In such a case, you can . use from tqdm.auto import tqdm to import tqdm | use %run instead of !python | . Example . Suppose we have a file called example.py with the below code: . # example.py from tqdm.auto import tqdm for i in tqdm(range(int(10e6)),desc= &quot;My Progress Bar&quot;): pass . Here&#39;s what we get if we use the !python command to run example.py . You can see that the progress bar is not displaying and it prints a newline in every iteration. . !python example.py . My Progress Bar: 0% 0/10000000 [00:00&lt;?, ?it/s]0 sample message My Progress Bar: 20% 1981993/10000000 [00:00&lt;00:03, 2552169.70it/s]2000000 sample message My Progress Bar: 38% 3807601/10000000 [00:01&lt;00:02, 2602892.40it/s]4000000 sample message My Progress Bar: 59% 5937689/10000000 [00:02&lt;00:01, 2665162.41it/s]6000000 sample message My Progress Bar: 78% 7823203/10000000 [00:03&lt;00:00, 2664702.85it/s]8000000 sample message My Progress Bar: 100% 10000000/10000000 [00:03&lt;00:00, 2601683.79it/s] . To fix this, we can use the %run command instead of !python to run example.py . %run example.py . 0 sample message 2000000 sample message 4000000 sample message 6000000 sample message 8000000 sample message . Now the progress bar displays as expected. . . Use trange to keep track of epochs . trange is a shortcut for tqdm(range(args), **kwargs) . . Example . Using tqdm . from tqdm.notebook import tqdm from time import sleep for i in tqdm(range(10), desc=&quot;Text you want&quot;): sleep(.1) . Using trange . from tqdm.notebook import trange from time import sleep for i in trange(10,desc=&quot;Text you want&quot;): sleep(.1) . You can see that the outputs are the same. . . Training with multiple epochs . We often train a deep learning model with more than one epoch. In this case, we can use trange to keep track of the progress of epochs. . Example . from tqdm.notebook import trange, tqdm for i in trange(3,desc= &#39;Epoch&#39;): print(&#39; nEpoch&#39;, i) for batch_index, data in tqdm(enumerate(train_dataloader), total=len(train_dataloader), desc =&quot;Text You Want&quot;, #disable = True, #file=sys.stdout, #initial=1000 ): text = data[&#39;text&#39;] label = data[&#39;label&#39;] # print batch information every 700 batches if batch_index % 1000 == 0: print(f&#39; nBatch {batch_index} n firs text: {text[0]}, n first label: {label[0]}&#39;) . Epoch 0 Batch 0 firs text: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again., first label: 2 Batch 1000 firs text: Microsoft Set to Deliver New Windows Service Pack Beta Microsoft is poised to deliver a new interim build of its Windows Server 2003 SP1 (Service Pack 1) to testers. Windows Server 2003 SP1 is the server complement to the recently released Windows XP SP2 (Service , first label: 3 Epoch 1 Batch 0 firs text: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again., first label: 2 Batch 1000 firs text: Microsoft Set to Deliver New Windows Service Pack Beta Microsoft is poised to deliver a new interim build of its Windows Server 2003 SP1 (Service Pack 1) to testers. Windows Server 2003 SP1 is the server complement to the recently released Windows XP SP2 (Service , first label: 3 Epoch 2 Batch 0 firs text: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again., first label: 2 Batch 1000 firs text: Microsoft Set to Deliver New Windows Service Pack Beta Microsoft is poised to deliver a new interim build of its Windows Server 2003 SP1 (Service Pack 1) to testers. Windows Server 2003 SP1 is the server complement to the recently released Windows XP SP2 (Service , first label: 3 . .",
            "url": "https://www.intodeeplearning.com/use-tqdm-to-monitor-model-training-progress/",
            "relUrl": "/use-tqdm-to-monitor-model-training-progress/",
            "date": " • Jun 9, 2022"
        }
        
    
  
    
        ,"post3": {
            "title": "How to use pytorch DataLoader",
            "content": "If you use pytorch as your deep learning framework, it&#39;s likely that you&#39;ll need to use DataLoader in your model training loop. . In this tutorial, you&#39;ll learn about . How to construct a custom Dataset class | How to use DataLoader to split a dataset into batches | How to randomize a dataset in DataLoader | How to return the randomized index in DataLoader | . What are pytorch DataLoader and Dataset . A Dataset is a container of your data that . has a length attribute, i.e. you can do len(dataset) | is indexable, i.e.you can do dataset[index] | . . Creating a Custom Dataset . A custom Dataset class must have three functions: . __init__ : instantiates the Dataset object | __len__: returns the number of samples in the dataset | __getitem__: loads and returns a sample from the dataset at the given index idx | . Here&#39;s an example custom dataset that takes in a pandas DataFrame with columns &quot;text&quot; and &quot;label&quot;. . from torch.utils.data import Dataset class NewsDataset(Dataset): def __init__(self, df): self.df = df self.texts = df[&#39;text&#39;] self.labels = df[&#39;label&#39;] def __len__(self): return len(self.labels) def __getitem__(self, idx): text = self.texts.iloc[idx] label = self.labels.iloc[idx] return text,label . . Creating a DataFrame with news data . To see how this custom dataset works, let&#39;s create a DataFrame with some news data from agnews dataset and put it into a NewsDataset we just created. . You can refer here for a more detailed tutorial on loading datasets from the Hugging Face Datasets. . from datasets import load_dataset agnews = load_dataset(&#39;ag_news&#39;) agnews.set_format(type=&quot;pandas&quot;) news_df = agnews[&#39;train&#39;][:25] . Using custom data configuration default Reusing dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548) . . news_df.head() . text label . 0 Wall St. Bears Claw Back Into the Black (Reute... | 2 | . 1 Carlyle Looks Toward Commercial Aerospace (Reu... | 2 | . 2 Oil and Economy Cloud Stocks&#39; Outlook (Reuters... | 2 | . 3 Iraq Halts Oil Exports from Main Southern Pipe... | 2 | . 4 Oil prices soar to all-time record, posing new... | 2 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt; Initiating a NewsDataset . news_dataset = NewsDataset(news_df) . Check if news_dataset has a length . len(news_dataset) . 25 . This means that the news_dataset has 25 news data. Now check if the news_dataset is indexable. . news_dataset[7] . (&#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;, 2) . We can see that the index 7 of news_dataset has a piece of news with label 2. . . Initiating a DataLoader . A DataLoader splits a dataset into batches which can be used for training. . You can adjust the batch size with the parameter batch_size. . from torch.utils.data import DataLoader news_dataloader = DataLoader(news_dataset,batch_size=4) . To load the data in batches, we can do . for batch_index, (batch,label) in enumerate(news_dataloader): print(f&#39;batch index: {batch_index}, n label: {label}, n batch: {batch}&#39;) . batch index: 0, label: tensor([2, 2, 2, 2]), batch: (&#34;Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#39;Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market.&#39;, &#34;Oil and Economy Cloud Stocks&#39; Outlook (Reuters) Reuters - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters - Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday.&#39;) batch index: 1, label: tensor([2, 2, 2, 2]), batch: (&#39;Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP - Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections.&#39;, &#39;Stocks End Up, But Near Year Lows (Reuters) Reuters - Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past #36;46 a barrel, offsetting a positive outlook from computer maker Dell Inc. (DELL.O)&#39;, &#34;Money Funds Fell in Latest Week (AP) AP - Assets of the nation&#39;s retail money market mutual funds fell by #36;1.17 billion in the latest week to #36;849.98 trillion, the Investment Company Institute said Thursday.&#34;, &#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;) batch index: 2, label: tensor([2, 2, 2, 2]), batch: (&#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;, &#34;Wall St. Bears Claw Back Into the Black NEW YORK (Reuters) - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#34;Oil and Economy Cloud Stocks&#39; Outlook NEW YORK (Reuters) - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#34;No Need for OPEC to Pump More-Iran Gov TEHRAN (Reuters) - OPEC can do nothing to douse scorching oil prices when markets are already oversupplied by 2.8 million barrels per day (bpd) of crude, Iran&#39;s OPEC governor said Saturday, warning that prices could fall sharply.&#34;) batch index: 3, label: tensor([2, 2, 2, 2]), batch: (&#39;Non-OPEC Nations Should Up Output-Purnomo JAKARTA (Reuters) - Non-OPEC oil exporters should consider increasing output to cool record crude prices, OPEC President Purnomo Yusgiantoro said on Sunday.&#39;, &#34;Google IPO Auction Off to Rocky Start WASHINGTON/NEW YORK (Reuters) - The auction for Google Inc.&#39;s highly anticipated initial public offering got off to a rocky start on Friday after the Web search company sidestepped a bullet from U.S. securities regulators.&#34;, &#34;Dollar Falls Broadly on Record Trade Gap NEW YORK (Reuters) - The dollar tumbled broadly on Friday after data showing a record U.S. trade deficit in June cast fresh doubts on the economy&#39;s recovery and its ability to draw foreign capital to fund the growing gap.&#34;, &#34;Rescuing an Old Saver If you think you may need to help your elderly relatives with their finances, don&#39;t be shy about having the money talk -- soon.&#34;) batch index: 4, label: tensor([2, 2, 2, 2]), batch: (&#39;Kids Rule for Back-to-School The purchasing power of kids is a big part of why the back-to-school season has become such a huge marketing phenomenon.&#39;, &#34;In a Down Market, Head Toward Value Funds There is little cause for celebration in the stock market these days, but investors in value-focused mutual funds have reason to feel a bit smug -- if only because they&#39;ve lost less than the folks who stuck with growth.&#34;, &#39;US trade deficit swells in June The US trade deficit has exploded 19 to a record $55.8bn as oil costs drove imports higher, according to a latest figures.&#39;, &#34;Shell &#39;could be target for Total&#39; Oil giant Shell could be bracing itself for a takeover attempt, possibly from French rival Total, a press report claims.&#34;) batch index: 5, label: tensor([2, 2, 2, 2]), batch: (&#34;Google IPO faces Playboy slip-up The bidding gets underway for Google&#39;s public offering, despite last-minute worries over an interview with its bosses in Playboy magazine.&#34;, &#39;Eurozone economy keeps growing Official figures show the 12-nation eurozone economy continues to grow, but there are warnings it may slow down later in the year.&#39;, &#39;Expansion slows in Japan Economic growth in Japan slows down as the country experiences a drop in domestic and corporate spending.&#39;, &#39;Rand falls on shock SA rate cut Interest rates are trimmed to 7.5 by the South African central bank, but the lack of warning hits the rand and surprises markets.&#39;) batch index: 6, label: tensor([2]), batch: (&#39;Car prices down across the board The cost of buying both new and second hand cars fell sharply over the past five years, a new survey has found.&#39;,) . . The data loading order and Sampler . A DataLoader leverages a Sampler to generate indices of dataset for each batch. We can use either the parameter shuffle or sampler to adjust the order of indices. . . SequentialSampler . By default, the parameter shuffle is False. And the DataLoader will use a SequentialSampler that returns indices sequentially. . news_dataloader = DataLoader(news_dataset,batch_size=4) type(news_dataloader.sampler) . torch.utils.data.sampler.SequentialSampler . We can also explicitly create a SequentialSampler and pass it into a DataLoader using the parameter sampler. . # initiate a SequentialSampler from torch.utils.data import SequentialSampler sequential_news_sampler = SequentialSampler(news_dataset) # let&#39;s print out the indices in the SequentialSampler for i in sequential_news_sampler: print(i) . 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 . . news_dataloader = DataLoader(news_dataset,batch_size=4,sampler = sequential_news_sampler ) for batch_index, (batch,label) in enumerate(news_dataloader): print(f&#39;batch index: {batch_index}, n label: {label}, n batch: {batch}&#39;) . batch index: 0, label: tensor([2, 2, 2, 2]), batch: (&#34;Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#39;Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market.&#39;, &#34;Oil and Economy Cloud Stocks&#39; Outlook (Reuters) Reuters - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters - Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday.&#39;) batch index: 1, label: tensor([2, 2, 2, 2]), batch: (&#39;Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP - Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections.&#39;, &#39;Stocks End Up, But Near Year Lows (Reuters) Reuters - Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past #36;46 a barrel, offsetting a positive outlook from computer maker Dell Inc. (DELL.O)&#39;, &#34;Money Funds Fell in Latest Week (AP) AP - Assets of the nation&#39;s retail money market mutual funds fell by #36;1.17 billion in the latest week to #36;849.98 trillion, the Investment Company Institute said Thursday.&#34;, &#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;) batch index: 2, label: tensor([2, 2, 2, 2]), batch: (&#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;, &#34;Wall St. Bears Claw Back Into the Black NEW YORK (Reuters) - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#34;Oil and Economy Cloud Stocks&#39; Outlook NEW YORK (Reuters) - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#34;No Need for OPEC to Pump More-Iran Gov TEHRAN (Reuters) - OPEC can do nothing to douse scorching oil prices when markets are already oversupplied by 2.8 million barrels per day (bpd) of crude, Iran&#39;s OPEC governor said Saturday, warning that prices could fall sharply.&#34;) batch index: 3, label: tensor([2, 2, 2, 2]), batch: (&#39;Non-OPEC Nations Should Up Output-Purnomo JAKARTA (Reuters) - Non-OPEC oil exporters should consider increasing output to cool record crude prices, OPEC President Purnomo Yusgiantoro said on Sunday.&#39;, &#34;Google IPO Auction Off to Rocky Start WASHINGTON/NEW YORK (Reuters) - The auction for Google Inc.&#39;s highly anticipated initial public offering got off to a rocky start on Friday after the Web search company sidestepped a bullet from U.S. securities regulators.&#34;, &#34;Dollar Falls Broadly on Record Trade Gap NEW YORK (Reuters) - The dollar tumbled broadly on Friday after data showing a record U.S. trade deficit in June cast fresh doubts on the economy&#39;s recovery and its ability to draw foreign capital to fund the growing gap.&#34;, &#34;Rescuing an Old Saver If you think you may need to help your elderly relatives with their finances, don&#39;t be shy about having the money talk -- soon.&#34;) batch index: 4, label: tensor([2, 2, 2, 2]), batch: (&#39;Kids Rule for Back-to-School The purchasing power of kids is a big part of why the back-to-school season has become such a huge marketing phenomenon.&#39;, &#34;In a Down Market, Head Toward Value Funds There is little cause for celebration in the stock market these days, but investors in value-focused mutual funds have reason to feel a bit smug -- if only because they&#39;ve lost less than the folks who stuck with growth.&#34;, &#39;US trade deficit swells in June The US trade deficit has exploded 19 to a record $55.8bn as oil costs drove imports higher, according to a latest figures.&#39;, &#34;Shell &#39;could be target for Total&#39; Oil giant Shell could be bracing itself for a takeover attempt, possibly from French rival Total, a press report claims.&#34;) batch index: 5, label: tensor([2, 2, 2, 2]), batch: (&#34;Google IPO faces Playboy slip-up The bidding gets underway for Google&#39;s public offering, despite last-minute worries over an interview with its bosses in Playboy magazine.&#34;, &#39;Eurozone economy keeps growing Official figures show the 12-nation eurozone economy continues to grow, but there are warnings it may slow down later in the year.&#39;, &#39;Expansion slows in Japan Economic growth in Japan slows down as the country experiences a drop in domestic and corporate spending.&#39;, &#39;Rand falls on shock SA rate cut Interest rates are trimmed to 7.5 by the South African central bank, but the lack of warning hits the rand and surprises markets.&#39;) batch index: 6, label: tensor([2]), batch: (&#39;Car prices down across the board The cost of buying both new and second hand cars fell sharply over the past five years, a new survey has found.&#39;,) . . RandomSampler . To randomize the data loading order in news_dataloader, we can . 1. set the parameter shuffle to True . news_dataloader = DataLoader(news_dataset,batch_size=4,shuffle=True) for batch_index, (batch,label) in enumerate(news_dataloader): print(f&#39;batch index: {batch_index}, n label: {label}, n batch: {batch}&#39;) . batch index: 0, label: tensor([2, 2, 2, 2]), batch: (&#39;US trade deficit swells in June The US trade deficit has exploded 19 to a record $55.8bn as oil costs drove imports higher, according to a latest figures.&#39;, &#39;Kids Rule for Back-to-School The purchasing power of kids is a big part of why the back-to-school season has become such a huge marketing phenomenon.&#39;, &#39;Car prices down across the board The cost of buying both new and second hand cars fell sharply over the past five years, a new survey has found.&#39;, &#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;) batch index: 1, label: tensor([2, 2, 2, 2]), batch: (&#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;, &#39;Rand falls on shock SA rate cut Interest rates are trimmed to 7.5 by the South African central bank, but the lack of warning hits the rand and surprises markets.&#39;, &#34;Shell &#39;could be target for Total&#39; Oil giant Shell could be bracing itself for a takeover attempt, possibly from French rival Total, a press report claims.&#34;, &#34;Rescuing an Old Saver If you think you may need to help your elderly relatives with their finances, don&#39;t be shy about having the money talk -- soon.&#34;) batch index: 2, label: tensor([2, 2, 2, 2]), batch: (&#34;Google IPO Auction Off to Rocky Start WASHINGTON/NEW YORK (Reuters) - The auction for Google Inc.&#39;s highly anticipated initial public offering got off to a rocky start on Friday after the Web search company sidestepped a bullet from U.S. securities regulators.&#34;, &#39;Eurozone economy keeps growing Official figures show the 12-nation eurozone economy continues to grow, but there are warnings it may slow down later in the year.&#39;, &#34;Google IPO faces Playboy slip-up The bidding gets underway for Google&#39;s public offering, despite last-minute worries over an interview with its bosses in Playboy magazine.&#34;, &#39;Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP - Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections.&#39;) batch index: 3, label: tensor([2, 2, 2, 2]), batch: (&#34;Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#34;No Need for OPEC to Pump More-Iran Gov TEHRAN (Reuters) - OPEC can do nothing to douse scorching oil prices when markets are already oversupplied by 2.8 million barrels per day (bpd) of crude, Iran&#39;s OPEC governor said Saturday, warning that prices could fall sharply.&#34;, &#34;Oil and Economy Cloud Stocks&#39; Outlook NEW YORK (Reuters) - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Stocks End Up, But Near Year Lows (Reuters) Reuters - Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past #36;46 a barrel, offsetting a positive outlook from computer maker Dell Inc. (DELL.O)&#39;) batch index: 4, label: tensor([2, 2, 2, 2]), batch: (&#39;Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters - Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday.&#39;, &#34;Oil and Economy Cloud Stocks&#39; Outlook (Reuters) Reuters - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Expansion slows in Japan Economic growth in Japan slows down as the country experiences a drop in domestic and corporate spending.&#39;, &#34;Wall St. Bears Claw Back Into the Black NEW YORK (Reuters) - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;) batch index: 5, label: tensor([2, 2, 2, 2]), batch: (&#39;Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market.&#39;, &#34;Money Funds Fell in Latest Week (AP) AP - Assets of the nation&#39;s retail money market mutual funds fell by #36;1.17 billion in the latest week to #36;849.98 trillion, the Investment Company Institute said Thursday.&#34;, &#34;Dollar Falls Broadly on Record Trade Gap NEW YORK (Reuters) - The dollar tumbled broadly on Friday after data showing a record U.S. trade deficit in June cast fresh doubts on the economy&#39;s recovery and its ability to draw foreign capital to fund the growing gap.&#34;, &#34;In a Down Market, Head Toward Value Funds There is little cause for celebration in the stock market these days, but investors in value-focused mutual funds have reason to feel a bit smug -- if only because they&#39;ve lost less than the folks who stuck with growth.&#34;) batch index: 6, label: tensor([2]), batch: (&#39;Non-OPEC Nations Should Up Output-Purnomo JAKARTA (Reuters) - Non-OPEC oil exporters should consider increasing output to cool record crude prices, OPEC President Purnomo Yusgiantoro said on Sunday.&#39;,) . Note that the dataloader will automatically use RandomSampler as its sampler when shuffle is True . type(news_dataloader.sampler) . torch.utils.data.sampler.RandomSampler . We can also . 2. Pass a RandomSampler to a DataLoader . RandomSampler returns random indices. . # initiate a RandomSampler from torch.utils.data import RandomSampler random_news_sampler = RandomSampler(news_dataset) # print out the indices in the RandomSampler for i in random_news_sampler: print(i) . 15 23 16 8 1 3 7 20 12 13 9 24 0 19 5 22 6 18 21 11 10 2 17 4 14 . . We can then pass random_news_sampler to the dataloader using the parameter sampler. . random_news_dataloader = DataLoader(news_dataset,batch_size=4,sampler=random_news_sampler) for batch_index, (batch,label) in enumerate(random_news_dataloader): print(f&#39;batch index: {batch_index}, n label: {label}, n batch: {batch}&#39;) . batch index: 0, label: tensor([2, 2, 2, 2]), batch: (&#39;Car prices down across the board The cost of buying both new and second hand cars fell sharply over the past five years, a new survey has found.&#39;, &#34;In a Down Market, Head Toward Value Funds There is little cause for celebration in the stock market these days, but investors in value-focused mutual funds have reason to feel a bit smug -- if only because they&#39;ve lost less than the folks who stuck with growth.&#34;, &#34;Oil and Economy Cloud Stocks&#39; Outlook NEW YORK (Reuters) - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;) batch index: 1, label: tensor([2, 2, 2, 2]), batch: (&#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;, &#39;Stocks End Up, But Near Year Lows (Reuters) Reuters - Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past #36;46 a barrel, offsetting a positive outlook from computer maker Dell Inc. (DELL.O)&#39;, &#39;US trade deficit swells in June The US trade deficit has exploded 19 to a record $55.8bn as oil costs drove imports higher, according to a latest figures.&#39;, &#39;Eurozone economy keeps growing Official figures show the 12-nation eurozone economy continues to grow, but there are warnings it may slow down later in the year.&#39;) batch index: 2, label: tensor([2, 2, 2, 2]), batch: (&#39;Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters - Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday.&#39;, &#39;Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP - Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections.&#39;, &#39;Non-OPEC Nations Should Up Output-Purnomo JAKARTA (Reuters) - Non-OPEC oil exporters should consider increasing output to cool record crude prices, OPEC President Purnomo Yusgiantoro said on Sunday.&#39;, &#34;No Need for OPEC to Pump More-Iran Gov TEHRAN (Reuters) - OPEC can do nothing to douse scorching oil prices when markets are already oversupplied by 2.8 million barrels per day (bpd) of crude, Iran&#39;s OPEC governor said Saturday, warning that prices could fall sharply.&#34;) batch index: 3, label: tensor([2, 2, 2, 2]), batch: (&#34;Oil and Economy Cloud Stocks&#39; Outlook (Reuters) Reuters - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Expansion slows in Japan Economic growth in Japan slows down as the country experiences a drop in domestic and corporate spending.&#39;, &#34;Shell &#39;could be target for Total&#39; Oil giant Shell could be bracing itself for a takeover attempt, possibly from French rival Total, a press report claims.&#34;, &#39;Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market.&#39;) batch index: 4, label: tensor([2, 2, 2, 2]), batch: (&#34;Google IPO faces Playboy slip-up The bidding gets underway for Google&#39;s public offering, despite last-minute worries over an interview with its bosses in Playboy magazine.&#34;, &#34;Dollar Falls Broadly on Record Trade Gap NEW YORK (Reuters) - The dollar tumbled broadly on Friday after data showing a record U.S. trade deficit in June cast fresh doubts on the economy&#39;s recovery and its ability to draw foreign capital to fund the growing gap.&#34;, &#39;Rand falls on shock SA rate cut Interest rates are trimmed to 7.5 by the South African central bank, but the lack of warning hits the rand and surprises markets.&#39;, &#34;Google IPO Auction Off to Rocky Start WASHINGTON/NEW YORK (Reuters) - The auction for Google Inc.&#39;s highly anticipated initial public offering got off to a rocky start on Friday after the Web search company sidestepped a bullet from U.S. securities regulators.&#34;) batch index: 5, label: tensor([2, 2, 2, 2]), batch: (&#34;Rescuing an Old Saver If you think you may need to help your elderly relatives with their finances, don&#39;t be shy about having the money talk -- soon.&#34;, &#34;Money Funds Fell in Latest Week (AP) AP - Assets of the nation&#39;s retail money market mutual funds fell by #36;1.17 billion in the latest week to #36;849.98 trillion, the Investment Company Institute said Thursday.&#34;, &#34;Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#39;Kids Rule for Back-to-School The purchasing power of kids is a big part of why the back-to-school season has become such a huge marketing phenomenon.&#39;) batch index: 6, label: tensor([2]), batch: (&#34;Wall St. Bears Claw Back Into the Black NEW YORK (Reuters) - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;,) . Get the random indices from RandomSampler . Sometimes, we might want to get the random indices from the DataLoader. . One way to do this is to let the __getitem__ method in Dataset return a triple (index, data, label) . Define a new NewsDataset class: . class NewsDataset(Dataset): def __init__(self, df): self.df = df self.texts = df[&#39;text&#39;] self.labels = df[&#39;label&#39;] def __len__(self): return len(self.labels) def __getitem__(self, idx): text = self.texts.iloc[idx] label = self.labels.iloc[idx] return idx,text,label # &lt; make the dataset return the index as well . Let&#39;s see if the NewsDataset works as desired. . # Initiate a NewsDataset news_dataset = NewsDataset(news_df) # Access the news of index 8 news_dataset[8] . (8, &#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;, 2) . You can see in the output that now the news_dataset also returns the index. We can then create a DataLoader with this news_dataset. . # initiate a news RandomSampler random_news_sampler = RandomSampler(news_dataset) # initiate a news DataLoader random_news_dataloader = DataLoader(news_dataset,batch_size = 4,sampler=random_news_sampler) . When looping through the batches, use the according triple (index, batch, label) to store what we get form the dataloader. . for batch_index, (index,batch,label) in enumerate(random_news_dataloader): print(f&#39;batch index: {batch_index}, n index: {index}, n label: {label}, n batch: {batch}&#39;) . batch index: 0, index: tensor([ 1, 4, 7, 13]), label: tensor([2, 2, 2, 2]), batch: (&#39;Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters - Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market.&#39;, &#39;Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP - Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections.&#39;, &#39;Fed minutes show dissent over inflation (USATODAY.com) USATODAY.com - Retail sales bounced back a bit in July, and new claims for jobless benefits fell last week, the government said Thursday, indicating the economy is improving from a midsummer slump.&#39;, &#34;Google IPO Auction Off to Rocky Start WASHINGTON/NEW YORK (Reuters) - The auction for Google Inc.&#39;s highly anticipated initial public offering got off to a rocky start on Friday after the Web search company sidestepped a bullet from U.S. securities regulators.&#34;) batch index: 1, index: tensor([20, 11, 21, 17]), label: tensor([2, 2, 2, 2]), batch: (&#34;Google IPO faces Playboy slip-up The bidding gets underway for Google&#39;s public offering, despite last-minute worries over an interview with its bosses in Playboy magazine.&#34;, &#34;No Need for OPEC to Pump More-Iran Gov TEHRAN (Reuters) - OPEC can do nothing to douse scorching oil prices when markets are already oversupplied by 2.8 million barrels per day (bpd) of crude, Iran&#39;s OPEC governor said Saturday, warning that prices could fall sharply.&#34;, &#39;Eurozone economy keeps growing Official figures show the 12-nation eurozone economy continues to grow, but there are warnings it may slow down later in the year.&#39;, &#34;In a Down Market, Head Toward Value Funds There is little cause for celebration in the stock market these days, but investors in value-focused mutual funds have reason to feel a bit smug -- if only because they&#39;ve lost less than the folks who stuck with growth.&#34;) batch index: 2, index: tensor([23, 22, 19, 14]), label: tensor([2, 2, 2, 2]), batch: (&#39;Rand falls on shock SA rate cut Interest rates are trimmed to 7.5 by the South African central bank, but the lack of warning hits the rand and surprises markets.&#39;, &#39;Expansion slows in Japan Economic growth in Japan slows down as the country experiences a drop in domestic and corporate spending.&#39;, &#34;Shell &#39;could be target for Total&#39; Oil giant Shell could be bracing itself for a takeover attempt, possibly from French rival Total, a press report claims.&#34;, &#34;Dollar Falls Broadly on Record Trade Gap NEW YORK (Reuters) - The dollar tumbled broadly on Friday after data showing a record U.S. trade deficit in June cast fresh doubts on the economy&#39;s recovery and its ability to draw foreign capital to fund the growing gap.&#34;) batch index: 3, index: tensor([ 6, 12, 2, 5]), label: tensor([2, 2, 2, 2]), batch: (&#34;Money Funds Fell in Latest Week (AP) AP - Assets of the nation&#39;s retail money market mutual funds fell by #36;1.17 billion in the latest week to #36;849.98 trillion, the Investment Company Institute said Thursday.&#34;, &#39;Non-OPEC Nations Should Up Output-Purnomo JAKARTA (Reuters) - Non-OPEC oil exporters should consider increasing output to cool record crude prices, OPEC President Purnomo Yusgiantoro said on Sunday.&#39;, &#34;Oil and Economy Cloud Stocks&#39; Outlook (Reuters) Reuters - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;, &#39;Stocks End Up, But Near Year Lows (Reuters) Reuters - Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past #36;46 a barrel, offsetting a positive outlook from computer maker Dell Inc. (DELL.O)&#39;) batch index: 4, index: tensor([ 0, 15, 24, 9]), label: tensor([2, 2, 2, 2]), batch: (&#34;Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;, &#34;Rescuing an Old Saver If you think you may need to help your elderly relatives with their finances, don&#39;t be shy about having the money talk -- soon.&#34;, &#39;Car prices down across the board The cost of buying both new and second hand cars fell sharply over the past five years, a new survey has found.&#39;, &#34;Wall St. Bears Claw Back Into the Black NEW YORK (Reuters) - Short-sellers, Wall Street&#39;s dwindling band of ultra-cynics, are seeing green again.&#34;) batch index: 5, index: tensor([ 8, 3, 18, 16]), label: tensor([2, 2, 2, 2]), batch: (&#39;Safety Net (Forbes.com) Forbes.com - After earning a PH.D. in Sociology, Danny Bazil Riley started to work as the general manager at a commercial real estate firm at an annual base salary of #36;70,000. Soon after, a financial planner stopped by his desk to drop off brochures about insurance benefits available through his employer. But, at 32, &#34;buying insurance was the furthest thing from my mind,&#34; says Riley.&#39;, &#39;Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters - Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday.&#39;, &#39;US trade deficit swells in June The US trade deficit has exploded 19 to a record $55.8bn as oil costs drove imports higher, according to a latest figures.&#39;, &#39;Kids Rule for Back-to-School The purchasing power of kids is a big part of why the back-to-school season has become such a huge marketing phenomenon.&#39;) batch index: 6, index: tensor([10]), label: tensor([2]), batch: (&#34;Oil and Economy Cloud Stocks&#39; Outlook NEW YORK (Reuters) - Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums.&#34;,) . You can see that now the batches also contain the information of indices. . . Reference . Dataset and DataLoader begginer tutorial | DataLoader | SequentialSampler | RandomSampler | .",
            "url": "https://www.intodeeplearning.com/how-to-use-pytorch-dataloader/",
            "relUrl": "/how-to-use-pytorch-dataloader/",
            "date": " • Jun 2, 2022"
        }
        
    
  
    
        ,"post4": {
            "title": "How to use regex with Pandas DataFrame",
            "content": "In this tutorial, we will go over some useful functions in pandas that you can use with regular experessions to process texts. . function description . contains() | Test if pattern or regex is contained within a string of a Series or Index. | . count() | Count occurrences of pattern in each string of the Series/Index | . findall() | Find all occurrences of pattern or regular expression in the Series/Index. | . replace() | Replace each occurrence of pattern/regex in the Series/Index with a custom string | . split() | Split strings around given pattern | . Create a DataFrame if you&#39;d like to follow along with the tutorial: . from datasets import load_dataset agnews = load_dataset(&#39;ag_news&#39;) . Using custom data configuration default . Downloading and preparing dataset ag_news/default (download: 29.88 MiB, generated: 30.23 MiB, post-processed: Unknown size, total: 60.10 MiB) to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548... Dataset ag_news downloaded and prepared to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548. Subsequent calls will reuse this data. . . agnews.set_format(type=&quot;pandas&quot;) df = agnews[&#39;train&#39;][:] df.head() . text label . 0 Wall St. Bears Claw Back Into the Black (Reute... | 2 | . 1 Carlyle Looks Toward Commercial Aerospace (Reu... | 2 | . 2 Oil and Economy Cloud Stocks&#39; Outlook (Reuters... | 2 | . 3 Iraq Halts Oil Exports from Main Southern Pipe... | 2 | . 4 Oil prices soar to all-time record, posing new... | 2 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt; contains . find texts containing the word &quot;business&quot; | . df[df[&#39;text&#39;].str.contains(r&#39; bbusiness b&#39;)].head() . text label . 42 Technology company sues five ex-employees A M... | 2 | . 62 Downhome Pinoy Blues, Intersecting Life Paths,... | 2 | . 63 The Real Time Modern Manila Blues: Bill Monroe... | 2 | . 65 What are the best cities for business in Asia?... | 2 | . 74 HP to Buy Synstar Hewlett-Packard will pay $2... | 2 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt; count . count the total number of times the word &quot;business&quot; occurs in texts | . df[&#39;text&#39;].str.count(r&#39; bbusiness b&#39;).sum() . 2759 . findall . equivalent to re.findall() | see another tutorial on re.findall() and re.search() . | below is an example of how to find all the a&#39;s in texts . | . df[&#39;text&#39;].str.findall(r&#39; ba b&#39;) . 0 [] 1 [a] 2 [] 3 [a] 4 [a] ... 119995 [a] 119996 [a, a, a, a] 119997 [a] 119998 [] 119999 [a] Name: text, Length: 120000, dtype: object . replace . replace the all the occurence of &quot;today&quot; or &quot;Today&quot; with &quot;TODAYYYYYY&quot; | check second to the last row! | . df[&#39;text&#39;].str.replace(r&#39; b[Tt]oday b&#39;,&#39;TODAYYYYYY&#39;) . /usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:1: FutureWarning: The default value of regex will change from True to False in a future version. &#34;&#34;&#34;Entry point for launching an IPython kernel. . 0 Wall St. Bears Claw Back Into the Black (Reute... 1 Carlyle Looks Toward Commercial Aerospace (Reu... 2 Oil and Economy Cloud Stocks&#39; Outlook (Reuters... 3 Iraq Halts Oil Exports from Main Southern Pipe... 4 Oil prices soar to all-time record, posing new... ... 119995 Pakistan&#39;s Musharraf Says Won&#39;t Quit as Army C... 119996 Renteria signing a top-shelf deal Red Sox gene... 119997 Saban not going to Dolphins yet The Miami Dolp... 119998 TODAYYYYYY&#39;s NFL games PITTSBURGH at NY GIANTS... 119999 Nets get Carter from Raptors INDIANAPOLIS -- A... Name: text, Length: 120000, dtype: object . split . split texts by &quot;the&quot;, the function returns a list of strings | check first row of the output | . df[&#39;text&#39;].str.split(r&quot; bthe b&quot;) . 0 [Wall St. Bears Claw Back Into , Black (Reute... 1 [Carlyle Looks Toward Commercial Aerospace (Re... 2 [Oil and Economy Cloud Stocks&#39; Outlook (Reuter... 3 [Iraq Halts Oil Exports from Main Southern Pip... 4 [Oil prices soar to all-time record, posing ne... ... 119995 [Pakistan&#39;s Musharraf Says Won&#39;t Quit as Army ... 119996 [Renteria signing a top-shelf deal Red Sox gen... 119997 [Saban not going to Dolphins yet The Miami Dol... 119998 [Today&#39;s NFL games PITTSBURGH at NY GIANTS Tim... 119999 [Nets get Carter from Raptors INDIANAPOLIS -- ... Name: text, Length: 120000, dtype: object . You may be interested . how to load datasets from Hugging Face Datasets | .",
            "url": "https://www.intodeeplearning.com/use-regex-with-pandas/",
            "relUrl": "/use-regex-with-pandas/",
            "date": " • May 31, 2022"
        }
        
    
  
    
        ,"post5": {
            "title": "Search through texts with regex in python",
            "content": "In this tutorial, I will go over two common functions, re.findall() and re.search(), that I find useful to search through texts with. . 1.Create your regular expression pattern . I usually use regex101.com to check if my regular expression pattern matches the text I want . | A screenshot of example usage: . | Some common tokens I use . . : a single character | s : any white space | d : Andy digit | b : Any word boundary | w : any word character | a|b : match either a or b | (...): capture the ... part into groups | a?: zero or one of a | a* : zero or more of a | a+: one or more of a | a{8} : exactly 8 of a | . | . 2. Use re.findall() and re.search() to find your matches . re is a module in the python standard library that provides regular expression matching operation | Two of the most common functions I use are re.findall() and re.search() | . import re . . re.findall() . I use this function when I need to find every matches in the text | If multiple groups are present, it returns a list of tuples of strings matching the group | . Example: . text = &#39;The result depends on the number of capturing groups in the pattern. If there are no groups, return a list of strings matching the whole pattern.&#39; match = re.findall(r&#39; b( w+) b s(groups)&#39;,text) match . [(&#39;capturing&#39;, &#39;groups&#39;), (&#39;no&#39;, &#39;groups&#39;)] . . re.search() . This function returns the first match found in the text | I use this function when I only have to check whether there is a match in the text | . Example: . match = re.search(r&#39; b( w+) b s(groups)&#39;,text) match . &lt;re.Match object; span=(36, 52), match=&#39;capturing groups&#39;&gt; . If you want to check the matching groups of re.search(), you can do: . match.group(0),match.group(1), match.group(2) . (&#39;capturing groups&#39;, &#39;capturing&#39;, &#39;groups&#39;) . If you&#39;re interested in more background reading on regular expressions, here&#39;s an excellent chapter by Dan Jurafsky and James H. Martin. . Reference . official doc of the re module re.findall() | re.search() | . | .",
            "url": "https://www.intodeeplearning.com/search-through-texts-with-regex-in-python/",
            "relUrl": "/search-through-texts-with-regex-in-python/",
            "date": " • May 31, 2022"
        }
        
    
  
    
        ,"post6": {
            "title": "How to load datasets from Hugging Face Datasets",
            "content": "The Hugging Face Datasets makes thousands of datasets available that can be found on the Hub. Check if there&#39;s any dataset you would like to try out! In this tutorial, we will load the agnews dataset, a collection of more than 1 million news articles on four categories: world, sports, business, sci/tech. . 1. Install the datasets package . see the installation guide for more information | . !pip install datasets . Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/ Collecting datasets Downloading datasets-2.3.2-py3-none-any.whl (362 kB) |████████████████████████████████| 362 kB 8.0 MB/s Collecting aiohttp Downloading aiohttp-3.8.1-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (1.1 MB) |████████████████████████████████| 1.1 MB 49.1 MB/s Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.3.5) Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (21.3) Collecting fsspec[http]&gt;=2021.05.0 Downloading fsspec-2022.5.0-py3-none-any.whl (140 kB) |████████████████████████████████| 140 kB 53.1 MB/s Collecting responses&lt;0.19 Downloading responses-0.18.0-py3-none-any.whl (38 kB) Requirement already satisfied: dill&lt;0.3.6 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.5.1) Requirement already satisfied: pyarrow&gt;=6.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0.1) Requirement already satisfied: tqdm&gt;=4.62.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.64.0) Collecting huggingface-hub&lt;1.0.0,&gt;=0.1.0 Downloading huggingface_hub-0.7.0-py3-none-any.whl (86 kB) |████████████████████████████████| 86 kB 5.0 MB/s Requirement already satisfied: numpy&gt;=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.21.6) Collecting xxhash Downloading xxhash-3.0.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB) |████████████████████████████████| 212 kB 47.1 MB/s Requirement already satisfied: requests&gt;=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0) Requirement already satisfied: multiprocess in /usr/local/lib/python3.7/dist-packages (from datasets) (0.70.13) Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from datasets) (4.11.4) Collecting pyyaml&gt;=5.1 Downloading PyYAML-6.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (596 kB) |████████████████████████████████| 596 kB 49.8 MB/s Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub&lt;1.0.0,&gt;=0.1.0-&gt;datasets) (4.2.0) Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub&lt;1.0.0,&gt;=0.1.0-&gt;datasets) (3.7.1) Requirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging-&gt;datasets) (3.0.9) Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (2022.5.18.1) Requirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (3.0.4) Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (1.24.3) Requirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&gt;=2.19.0-&gt;datasets) (2.10) Collecting urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB) |████████████████████████████████| 127 kB 44.5 MB/s Collecting yarl&lt;2.0,&gt;=1.0 Downloading yarl-1.7.2-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (271 kB) |████████████████████████████████| 271 kB 45.6 MB/s Collecting aiosignal&gt;=1.1.2 Downloading aiosignal-1.2.0-py3-none-any.whl (8.2 kB) Collecting async-timeout&lt;5.0,&gt;=4.0.0a3 Downloading async_timeout-4.0.2-py3-none-any.whl (5.8 kB) Requirement already satisfied: charset-normalizer&lt;3.0,&gt;=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp-&gt;datasets) (2.0.12) Collecting multidict&lt;7.0,&gt;=4.5 Downloading multidict-6.0.2-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (94 kB) |████████████████████████████████| 94 kB 3.8 MB/s Collecting asynctest==0.13.0 Downloading asynctest-0.13.0-py3-none-any.whl (26 kB) Collecting frozenlist&gt;=1.1.1 Downloading frozenlist-1.3.0-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (144 kB) |████████████████████████████████| 144 kB 50.2 MB/s Requirement already satisfied: attrs&gt;=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp-&gt;datasets) (21.4.0) Requirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata-&gt;datasets) (3.8.0) Requirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;datasets) (2.8.2) Requirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;datasets) (2022.1) Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas-&gt;datasets) (1.15.0) Installing collected packages: multidict, frozenlist, yarl, urllib3, asynctest, async-timeout, aiosignal, pyyaml, fsspec, aiohttp, xxhash, responses, huggingface-hub, datasets Attempting uninstall: urllib3 Found existing installation: urllib3 1.24.3 Uninstalling urllib3-1.24.3: Successfully uninstalled urllib3-1.24.3 Attempting uninstall: pyyaml Found existing installation: PyYAML 3.13 Uninstalling PyYAML-3.13: Successfully uninstalled PyYAML-3.13 ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts. datascience 0.10.6 requires folium==0.2.1, but you have folium 0.8.3 which is incompatible. Successfully installed aiohttp-3.8.1 aiosignal-1.2.0 async-timeout-4.0.2 asynctest-0.13.0 datasets-2.3.2 frozenlist-1.3.0 fsspec-2022.5.0 huggingface-hub-0.7.0 multidict-6.0.2 pyyaml-6.0 responses-0.18.0 urllib3-1.25.11 xxhash-3.0.0 yarl-1.7.2 . . 2. Loading the dataset . The agnews dataset has data fields of: . text: a string feature. | label: a classification label, with possible values including World (0), Sports (1), Business (2), Sci/Tech (3). | . from datasets import load_dataset agnews = load_dataset(&#39;ag_news&#39;) agnews . Using custom data configuration default . Downloading and preparing dataset ag_news/default (download: 29.88 MiB, generated: 30.23 MiB, post-processed: Unknown size, total: 60.10 MiB) to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548... Dataset ag_news downloaded and prepared to /root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548. Subsequent calls will reuse this data. . DatasetDict({ train: Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 120000 }) test: Dataset({ features: [&#39;text&#39;, &#39;label&#39;], num_rows: 7600 }) }) . . We check the class lables by : . agnews[&#39;train&#39;].features . {&#39;label&#39;: ClassLabel(num_classes=4, names=[&#39;World&#39;, &#39;Sports&#39;, &#39;Business&#39;, &#39;Sci/Tech&#39;], id=None), &#39;text&#39;: Value(dtype=&#39;string&#39;, id=None)} . 3. (Optional) Convert a Dataset object to a Pandas DataFrame . When we&#39;re dealing with data, it&#39;s often more convenient to use a DataFrame. | . agnews.set_format(type=&quot;pandas&quot;) train_df = agnews[&#39;train&#39;][:] train_df.head() . text label . 0 Wall St. Bears Claw Back Into the Black (Reute... | 2 | . 1 Carlyle Looks Toward Commercial Aerospace (Reu... | 2 | . 2 Oil and Economy Cloud Stocks&#39; Outlook (Reuters... | 2 | . 3 Iraq Halts Oil Exports from Main Southern Pipe... | 2 | . 4 Oil prices soar to all-time record, posing new... | 2 | . &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; height=&quot;24px&quot;viewBox=&quot;0 0 24 24&quot; width=&quot;24px&quot;&gt; &lt;/svg&gt; That&#39;s it! Now you have the dataset at your disposal. Check out the official doc for more information! .",
            "url": "https://www.intodeeplearning.com/how-to-load-datasets-from-hugging-face-datasets/",
            "relUrl": "/how-to-load-datasets-from-hugging-face-datasets/",
            "date": " • May 30, 2022"
        }
        
    
  
    
        ,"post7": {
            "title": "How to import custom modules (.py files) from google drive in google colab",
            "content": "1. Mount your google drive in google colab . from google.colab import drive drive.mount(&#39;/content/gdrive/&#39;) . 2. Append the directory to your python path . For example, if you want to import a .py file called mymodule.py in your google drive, which is saved in &quot;/content/drive/MyDrive/example_folder&quot;, you need to add the path of the directory which saves mymodule.py to system path. . from pathlib import Path # the path of the directory which saves your .py file src_dir = Path(&#39;/content/drive/MyDrive/example_folder/&#39;) # add the path to system path import sys try: sys.path.index(str(src_dir)) except ValueError: sys.path.insert(0,str(src_dir)) # print system path sys.path . [&#39;/content/drive/MyDrive/example_folder&#39;, &#39;&#39;, &#39;/content&#39;, &#39;/env/python&#39;, &#39;/usr/lib/python37.zip&#39;, &#39;/usr/lib/python3.7&#39;, &#39;/usr/lib/python3.7/lib-dynload&#39;, &#39;/usr/local/lib/python3.7/dist-packages&#39;, &#39;/usr/lib/python3/dist-packages&#39;, &#39;/usr/local/lib/python3.7/dist-packages/IPython/extensions&#39;, &#39;/root/.ipython&#39;] . . After you follow the above steps, you should see /content/drive/MyDrive/example_folder in sys.path. . Now, try to import your custom module: . from mymodule import welcome welcome() . Nice to meet you! .",
            "url": "https://www.intodeeplearning.com/import-custom-modules-from-gdrive-in-google-colab/",
            "relUrl": "/import-custom-modules-from-gdrive-in-google-colab/",
            "date": " • May 29, 2022"
        }
        
    
  
    
        ,"post8": {
            "title": "Better ways to create a directory in python",
            "content": "When you&#39;re creating a new directory in python, it&#39;s better to check if that directory exists first, in case your code run into error. . Example 1 . use os.path.exists() to check if the directory&#39;s existence | then create a directory with os.mkdir() only if it does not exist | . import os path_to_dir = &#39;/content/test&#39; if not os.path.exists(path_to_dir): os.mkdir(path_to_dir) . Example 2 . use a try-except block to handle error | . import os path_to_dir = &#39;/content/test&#39; try: os.mkdir(path_to_dir ) except OSError as error: print(error) . [Errno 17] File exists: &#39;/content/test&#39; . Example 3 . use os.mkdirs() when there is any non-existent directory in your path | for instance, you want to create a directory in called /test2 in directory /test1, however directory /test1 is missing. | . import os path_to_dir = &#39;/content/test1/test2/&#39; try: os.mkdir(path_to_dir ) except OSError as error: print(error) .",
            "url": "https://www.intodeeplearning.com/better-ways-to-create-a-directory-in-python/",
            "relUrl": "/better-ways-to-create-a-directory-in-python/",
            "date": " • May 28, 2022"
        }
        
    
  
    
        ,"post9": {
            "title": "How to zip a folder and unzip a file in python",
            "content": "Create an example folder with files . %%shell mkdir test touch test/file1.txt touch test/file2.txt . . Zip a folder . import shutil dir_name = &#39;/content/test/&#39; output_filename = &#39;test&#39; shutil.make_archive(output_filename, &#39;zip&#39;, dir_name) . &#39;/content/test.zip&#39; . Unzip a file . import zipfile path_to_zip_file =&#39;/content/test.zip&#39; directory_to_extract_to = &#39;/content/test1/&#39; with zipfile.ZipFile(path_to_zip_file, &#39;r&#39;) as zip_ref: zip_ref.extractall(directory_to_extract_to) . use the code below to delete your zip file if needed: . import os if os.path.exists(path_to_zip_file): os.remove(path_to_zip_file) .",
            "url": "https://www.intodeeplearning.com/how-to-zip-a-folder-and-unzip-a-file/",
            "relUrl": "/how-to-zip-a-folder-and-unzip-a-file/",
            "date": " • May 27, 2022"
        }
        
    
  
    
        ,"post10": {
            "title": "How to setup google domain for your fastpages site (or GitHub Pages)",
            "content": "Introduction . When you publish a site with GitHub Pages, the default address will look something like this: https://&lt;username&gt;.github.io/&lt;repo name&gt;. For example, https://intodeeplearning.github.io/blog. . If you’d like to replace the default address with your custom domain, such as https://intodeeplearning.com , follow this tutorial! . What you will get in this tutorial . Setting up a custom www subdomain, such as www.example.com, for your GitHub Pages | having the apex domain, such as example.com, automatically redirect to www.example.com | . What you need . A GitHub repository ready for publishing, such as https://github.com/intodeeplearning/blog | A purchased google domain, such as “intodeeplearning.com” | . . Step 1. Setup in your Github Repo . Go to Settings &gt; Pages &gt; Custom domain, and add you custom domain name, such as “www.intodeeplearning.com” . . | . Step 2. (Optional) You can skip this step if you are NOT using a site generator, such as fastpages, or Jekyll . If you are using fastpages. . Add a CNAME file in the root of your repo. . www.intodeeplearning.com . | In _config.yml set url to your custom www subdomain andbaseurl to &quot;&quot; . . url: &#39;https://www.intodeeplearning.com&#39; baseurl: &#39;&#39; . | In _action_files/settings.ini, empty baseurl. . baseurl= . | You can also refer to Fastpages: using a custom domain . | . Step 3. Let your custom domain point to your GitHub Pages . Go to your google domain registrar and select your domain. . | Go to the DNS tab . . | Under the Resource records section, click Manage custom records . . | Create a CNAME record that points your www subdomain to &lt;your_github_username&gt;.github.io . . Do NOT include the repository name, such as intodeeplearning.github.io/blog. If you include your repository name in the CNAME record to your DNS provider, you’ll get the below message at your GitHub Settings &gt; Pages &gt; Custom domain . . | . | Create an A record that points to the IP addresses for Github Pages. . . IP addresses in the screenshot . 185.199.108.153 185.199.109.153 185.199.110.153 185.199.111.153 . | Check here if there’s an update in the IP addresses. . | . | Open Terminal to confirm that your DNS record configured correctly . For CNAME records, do . dig www.intodeeplearning.com +nostats +nocomments +nocmd . You should get . ; &lt;&lt;&gt;&gt; DiG 9.10.6 &lt;&lt;&gt;&gt; www.intodeeplearning.com +nostats +nocomments +nocmd ;; global options: +cmd ;www.intodeeplearning.com. IN A www.intodeeplearning.com. 3312 IN CNAME intodeeplearning.github.io. intodeeplearning.github.io. 3312 IN A 185.199.110.153 intodeeplearning.github.io. 3312 IN A 185.199.111.153 intodeeplearning.github.io. 3312 IN A 185.199.109.153 intodeeplearning.github.io. 3312 IN A 185.199.108.153 . | . | For A records, do . dig intodeeplearning.com +noall +answer -t A . You should get . ;; global options: +cmd intodeeplearning.com. 928 IN A 185.199.109.153 intodeeplearning.com. 928 IN A 185.199.108.153 intodeeplearning.com. 928 IN A 185.199.110.153 intodeeplearning.com. 928 IN A 185.199.111.153 . | . | . | . Step 4. Enable HTTPS for you GitHub Pages . Go to your github repository settings page, under Settings &gt; Pages, remove your custom domain and save. . | Then add it back and save again. . | Now you should be able to check the Enforce HTTPS checkbox . . | Note: DNS changes can take up to 24 hours to propagate. . You may use dns propagation checker to check if you DNS has successfully propagated. . | See GitHub Pages trouble shoot for more questions. . | . | . That’s it! Your website should be publishing at your custom domain now! . Reference . Official Github Tutorial About custom domains and GitHub Pages . We recommend always using a www subdomain configurations for your site. If you configure a www subdomain, we automatically attempt to secure the associated apex domain. . If you configure www.example.com as the custom domain for your site, and you have GitHub Pages DNS records set up for the apex and www domains, then example.com will redirect to www.example.com . wwwsubdomains are the most stable type of custom domain because www subdomains are not affected by changes to the IP addresses of GitHub Enterprise Cloud’s servers. . | Managing a custom domain for your GitHub Pages site | Configuring a subdomain | . | .",
            "url": "https://www.intodeeplearning.com/setup-google-domain-for-github-pages/",
            "relUrl": "/setup-google-domain-for-github-pages/",
            "date": " • May 20, 2022"
        }
        
    
  
    
        ,"post11": {
            "title": "Embedding images in google drive to markdown",
            "content": "1. Create a link for your image in your google drive . a. Upload your image to your google drive . b. Right-Click the your file . c. Click on Get Link . d. Make sure to change the Restricted mode of sharing to Anyone with the link . . e. Click on Copy Link. The link will be in the following format: https://drive.google.com/file/d/&lt;ID of image&gt;/view?usp=sharing . &lt;ID of image&gt; is your google drive file ID | . f. Get the &lt;ID of image&gt; and create a link in the following format for embedding: https://drive.google.com/uc?id=&lt;ID of image&gt; . This is the link we’ll use in markdown/html code. | . For example: . my link: https://drive.google.com/file/d/1L07w0_Qg9q-0Ukm4-K3i8ffyk34FqTzA/view?usp=sharing | &lt;ID of image&gt; is 1L07w0_Qg9q-0Ukm4-K3i8ffyk34FqTzA | my embedding link: https://drive.google.com/uc?id=1L07w0_Qg9q-0Ukm4-K3i8ffyk34FqTzA | . 2. Use the link in markdown . To embed an image using markdown, use the following: . ![Example Image](https://drive.google.com/uc?id=1bXzYeegauqB2M6-VZwitEeXHmMiYZIUY) . The image will be like: . . 3. (Optional) Use the link in HTML code for more flexibility . Using markdown is easy. However, this does not give us much flexibility in adjusting the images. Instead, we can use the html code below. . &lt;img src=&quot;https://drive.google.com/uc?id=1bXzYeegauqB2M6-VZwitEeXHmMiYZIUY&quot; alt=&quot;sample image&quot; style=&quot;display: block; margin-right: auto; margin-left: auto; width: 90%; box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19)&quot; /&gt; . I put some shadow for the image and also shrink it to 90%. The image will be like: . . Reference . css box-shadow | css center images | .",
            "url": "https://www.intodeeplearning.com/embedding-images-in-google-drive-to-markdown/",
            "relUrl": "/embedding-images-in-google-drive-to-markdown/",
            "date": " • May 11, 2022"
        }
        
    
  
    
        ,"post12": {
            "title": "How to delete files and folders in python",
            "content": "Delete files . import os path = &#39;/file_name&#39; if os.path.exists(path): os.remove(path) . Delete empty folders . import os path = &#39;/folder_name&#39; if os.path.exists(pathe): os.remdir(path) . Delete folders with files . import shutil path = &#39;/folder_name&#39; if os.path.isdir(path): shutil.rmtree(path) .",
            "url": "https://www.intodeeplearning.com/how-to-delete-files-and-folders-in-python/",
            "relUrl": "/how-to-delete-files-and-folders-in-python/",
            "date": " • May 10, 2022"
        }
        
    
  
    
        ,"post13": {
            "title": "How to download files or folders in google drive in python",
            "content": "1. Get a Direct Link for Your Google Drive Files . a. open Google Drive . b. Right-click on your file . c. Click on Get Link . d. Make sure your file is available for “Anyone with the link” . . e. Click on Copy Link . 2. Install gdown . gdown doc | . !pip install gdown . 3. Download the file in google drive using Python . import gdown url = &#39;https://drive.google.com/file/d/1uFTzwFc3tmS-D7azjMiJcxSfn71BPqKt/view?usp=sharing&#39; output_path = &#39;graph_ML.pk&#39; gdown.download(url, output_path, quiet=False,fuzzy=True) . Downloading... From: https://drive.google.com/uc?id=1uFTzwFc3tmS-D7azjMiJcxSfn71BPqKt To: /content/graph_ML.pk 100%|██████████| 1.94G/1.94G [00:23&lt;00:00, 82.2MB/s] . &#39;graph_ML.pk&#39; . . 4. Download a folder in google drive using Python . import gdown url = &quot;https://drive.google.com/drive/folders/1HWFHKCprFzR7H7TYhrE-W7v4bz2Vc7Ia&quot; gdown.download_folder(url, quiet=True, use_cookies=False) . [&#39;/content/ihpperson_data_with_rules/civil_servant.csv&#39;, &#39;/content/ihpperson_data_with_rules/eunuch.csv&#39;, &#39;/content/ihpperson_data_with_rules/general.csv&#39;, &#39;/content/ihpperson_data_with_rules/remain_person.csv&#39;, &#39;/content/ihpperson_data_with_rules/special_general.csv&#39;] . . .",
            "url": "https://www.intodeeplearning.com/how-to-download-files-or-folders-in-gdrive-in-python/",
            "relUrl": "/how-to-download-files-or-folders-in-gdrive-in-python/",
            "date": " • May 8, 2022"
        }
        
    
  
    
        ,"post14": {
            "title": "How to Write an Abstract",
            "content": "Why is a good abstract important? . People often judge from an abstract of a paper to decide whether or not they want to invest their time in it. | Online databases typically contain only abstracts. | Editors or reviewers use abstracts as the first parts to evaluate your work. | . Hence, a concise and effective abstract well-describing your work increases search-ability and readership, and most important of all, expedite editorial evaluation. . My steps for writing an abstract . Write the paper first, and then use the abstract as a self-contained summary. | As I start to work on the abstract, I go over the paper and outline the following: . Elements I collect before for an abstract . Motivation of my work (Optional) Why do my readers need to care about the problem? strengthen the importance of my work | . | If 1) the motivation could not be easily written . or 2) the problem is widely recognized as important, I’ll give a brief introduction to the problem/research area instead, or just skip this part. . Ex: mention the difficulty of the research area | . | . | Problem statement What is the problem I am trying to solve? | Clearly define the scope of my work, ex: a general approach, a framework for historical research | . | Approach What is my method? How did I solve the problem? | . | Results What’s the result of my approach? This is usually the evaluation part of the designed model. | ex: better performance. | . | focus on key results and findings | . | Conclusion What are the implications of the results/findings? Why does it matter? What’s the impact? | What is the message I want my readers to take home (remember about my work)? | . | . | Other considerations Include keywords or phrases to help readers search for my paper | Don’t include citations or references, unless you know your audience will be experts in this research area. Keep it straightforward for a general audience | . | After finishing the first draft of the abstract. I check if all the key ideas of the paper are included. |",
            "url": "https://www.intodeeplearning.com/how-to-write-an-abstract/",
            "relUrl": "/how-to-write-an-abstract/",
            "date": " • Apr 25, 2022"
        }
        
    
  
    
        ,"post15": {
            "title": "Fastpages Notebook Blog Post",
            "content": "About . This notebook is a demonstration of some of capabilities of fastpages with notebooks. . With fastpages you can save your jupyter notebooks into the _notebooks folder at the root of your repository, and they will be automatically be converted to Jekyll compliant blog posts! . Front Matter . The first cell in your Jupyter Notebook or markdown blog post contains front matter. Front matter is metadata that can turn on/off options in your Notebook. It is formatted like this: . # &quot;My Title&quot; &gt; &quot;Awesome summary&quot; - toc:true- branch: master - badges: true - comments: true - author: Hamel Husain &amp; Jeremy Howard - categories: [fastpages, jupyter] . Setting toc: true will automatically generate a table of contents | Setting badges: true will automatically include GitHub and Google Colab links to your notebook. | Setting comments: true will enable commenting on your blog post, powered by utterances. | . The title and description need to be enclosed in double quotes only if they include special characters such as a colon. More details and options for front matter can be viewed on the front matter section of the README. . Markdown Shortcuts . A #hide comment at the top of any code cell will hide both the input and output of that cell in your blog post. . A #hide_input comment at the top of any code cell will only hide the input of that cell. . The comment #hide_input was used to hide the code that produced this. . put a #collapse-hide flag at the top of any cell if you want to hide that cell by default, but give the reader the option to show it: . import pandas as pd import altair as alt . . put a #collapse-show flag at the top of any cell if you want to show that cell by default, but give the reader the option to hide it: . cars = &#39;https://vega.github.io/vega-datasets/data/cars.json&#39; movies = &#39;https://vega.github.io/vega-datasets/data/movies.json&#39; sp500 = &#39;https://vega.github.io/vega-datasets/data/sp500.csv&#39; stocks = &#39;https://vega.github.io/vega-datasets/data/stocks.csv&#39; flights = &#39;https://vega.github.io/vega-datasets/data/flights-5k.json&#39; . . place a #collapse-output flag at the top of any cell if you want to put the output under a collapsable element that is closed by default, but give the reader the option to open it: . print(&#39;The comment #collapse-output was used to collapse the output of this cell by default but you can expand it.&#39;) . The comment #collapse-output was used to collapse the output of this cell by default but you can expand it. . . Interactive Charts With Altair . Charts made with Altair remain interactive. Example charts taken from this repo, specifically this notebook. . Example 1: DropDown . # use specific hard-wired values as the initial selected values selection = alt.selection_single( name=&#39;Select&#39;, fields=[&#39;Major_Genre&#39;, &#39;MPAA_Rating&#39;], init={&#39;Major_Genre&#39;: &#39;Drama&#39;, &#39;MPAA_Rating&#39;: &#39;R&#39;}, bind={&#39;Major_Genre&#39;: alt.binding_select(options=genres), &#39;MPAA_Rating&#39;: alt.binding_radio(options=mpaa)} ) # scatter plot, modify opacity based on selection alt.Chart(df).mark_circle().add_selection( selection ).encode( x=&#39;Rotten_Tomatoes_Rating:Q&#39;, y=&#39;IMDB_Rating:Q&#39;, tooltip=&#39;Title:N&#39;, opacity=alt.condition(selection, alt.value(0.75), alt.value(0.05)) ) . Example 2: Tooltips . alt.Chart(df).mark_circle().add_selection( alt.selection_interval(bind=&#39;scales&#39;, encodings=[&#39;x&#39;]) ).encode( alt.X(&#39;Rotten_Tomatoes_Rating&#39;, type=&#39;quantitative&#39;), alt.Y(&#39;IMDB_Rating&#39;, type=&#39;quantitative&#39;, axis=alt.Axis(minExtent=30)), # y=alt.Y(&#39;IMDB_Rating:Q&#39;, ), # use min extent to stabilize axis title placement tooltip=[&#39;Title:N&#39;, &#39;Release_Date:N&#39;, &#39;IMDB_Rating:Q&#39;, &#39;Rotten_Tomatoes_Rating:Q&#39;] ).properties( width=500, height=400 ) . Example 3: More Tooltips . label = alt.selection_single( encodings=[&#39;x&#39;], # limit selection to x-axis value on=&#39;mouseover&#39;, # select on mouseover events nearest=True, # select data point nearest the cursor empty=&#39;none&#39; # empty selection includes no data points ) # define our base line chart of stock prices base = alt.Chart().mark_line().encode( alt.X(&#39;date:T&#39;), alt.Y(&#39;price:Q&#39;, scale=alt.Scale(type=&#39;log&#39;)), alt.Color(&#39;symbol:N&#39;) ) alt.layer( base, # base line chart # add a rule mark to serve as a guide line alt.Chart().mark_rule(color=&#39;#aaa&#39;).encode( x=&#39;date:T&#39; ).transform_filter(label), # add circle marks for selected time points, hide unselected points base.mark_circle().encode( opacity=alt.condition(label, alt.value(1), alt.value(0)) ).add_selection(label), # add white stroked text to provide a legible background for labels base.mark_text(align=&#39;left&#39;, dx=5, dy=-5, stroke=&#39;white&#39;, strokeWidth=2).encode( text=&#39;price:Q&#39; ).transform_filter(label), # add text labels for stock prices base.mark_text(align=&#39;left&#39;, dx=5, dy=-5).encode( text=&#39;price:Q&#39; ).transform_filter(label), data=stocks ).properties( width=500, height=400 ) . Data Tables . You can display tables per the usual way in your blog: . df[[&#39;Title&#39;, &#39;Worldwide_Gross&#39;, &#39;Production_Budget&#39;, &#39;Distributor&#39;, &#39;MPAA_Rating&#39;, &#39;IMDB_Rating&#39;, &#39;Rotten_Tomatoes_Rating&#39;]].head() . Title Worldwide_Gross Production_Budget Distributor MPAA_Rating IMDB_Rating Rotten_Tomatoes_Rating . 0 The Land Girls | 146083.0 | 8000000.0 | Gramercy | R | 6.1 | NaN | . 1 First Love, Last Rites | 10876.0 | 300000.0 | Strand | R | 6.9 | NaN | . 2 I Married a Strange Person | 203134.0 | 250000.0 | Lionsgate | None | 6.8 | NaN | . 3 Let&#39;s Talk About Sex | 373615.0 | 300000.0 | Fine Line | None | NaN | 13.0 | . 4 Slam | 1087521.0 | 1000000.0 | Trimark | R | 3.4 | 62.0 | . Images . Local Images . You can reference local images and they will be copied and rendered on your blog automatically. You can include these with the following markdown syntax: . ![](my_icons/fastai_logo.png) . . Remote Images . Remote images can be included with the following markdown syntax: . ![](https://image.flaticon.com/icons/svg/36/36686.svg) . . Animated Gifs . Animated Gifs work, too! . ![](https://upload.wikimedia.org/wikipedia/commons/7/71/ChessPawnSpecialMoves.gif) . . Captions . You can include captions with markdown images like this: . ![](https://www.fast.ai/images/fastai_paper/show_batch.png &quot;Credit: https://www.fast.ai/2020/02/13/fastai-A-Layered-API-for-Deep-Learning/&quot;) . . Other Elements . GitHub Flavored Emojis . Typing I give this post two :+1:! will render this: . I give this post two :+1:! . Tweetcards . Typing &gt; twitter: https://twitter.com/jakevdp/status/1204765621767901185?s=20 will render this: Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 . Youtube Videos . Typing &gt; youtube: https://youtu.be/XfoYk_Z5AkI will render this: . Boxes / Callouts . Typing &gt; Warning: There will be no second warning! will render this: . Warning: There will be no second warning! . Typing &gt; Important: Pay attention! It&#39;s important. will render this: . Important: Pay attention! It&#8217;s important. . Typing &gt; Tip: This is my tip. will render this: . Tip: This is my tip. . Typing &gt; Note: Take note of this. will render this: . Note: Take note of this. . Typing &gt; Note: A doc link to [an example website: fast.ai](https://www.fast.ai/) should also work fine. will render in the docs: . Note: A doc link to an example website: fast.ai should also work fine. . Footnotes . You can have footnotes in notebooks, however the syntax is different compared to markdown documents. This guide provides more detail about this syntax, which looks like this: . For example, here is a footnote {% fn 1 %}. And another {% fn 2 %} {{ &#39;This is the footnote.&#39; | fndetail: 1 }} {{ &#39;This is the other footnote. You can even have a [link](www.github.com)!&#39; | fndetail: 2 }} . For example, here is a footnote 1. . And another 2 . 1. This is the footnote.↩ . 2. This is the other footnote. You can even have a link!↩ .",
            "url": "https://www.intodeeplearning.com/2020/02/20/test.html",
            "relUrl": "/2020/02/20/test.html",
            "date": " • Feb 20, 2020"
        }
        
    
  
    
        ,"post16": {
            "title": "An Example Markdown Post",
            "content": "Example Markdown Post . Basic setup . Jekyll requires blog post files to be named according to the following format: . YEAR-MONTH-DAY-filename.md . Where YEAR is a four-digit number, MONTH and DAY are both two-digit numbers, and filename is whatever file name you choose, to remind yourself what this post is about. .md is the file extension for markdown files. . The first line of the file should start with a single hash character, then a space, then your title. This is how you create a “level 1 heading” in markdown. Then you can create level 2, 3, etc headings as you wish but repeating the hash character, such as you see in the line ## File names above. . Basic formatting . You can use italics, bold, code font text, and create links. Here’s a footnote 1. Here’s a horizontal rule: . . Lists . Here’s a list: . item 1 | item 2 | . And a numbered list: . item 1 | item 2 | Boxes and stuff . This is a quotation . . You can include alert boxes …and… . . You can include info boxes Images . . Code . You can format text and code per usual . General preformatted text: . # Do a thing do_thing() . Python code and output: . # Prints &#39;2&#39; print(1+1) . 2 . Formatting text as shell commands: . echo &quot;hello world&quot; ./some_script.sh --option &quot;value&quot; wget https://example.com/cat_photo1.png . Formatting text as YAML: . key: value - another_key: &quot;another value&quot; . Tables . Column 1 Column 2 . A thing | Another thing | . Tweetcards . Altair 4.0 is released! https://t.co/PCyrIOTcvvTry it with: pip install -U altairThe full list of changes is at https://t.co/roXmzcsT58 ...read on for some highlights. pic.twitter.com/vWJ0ZveKbZ . &mdash; Jake VanderPlas (@jakevdp) December 11, 2019 Footnotes . This is the footnote. &#8617; . |",
            "url": "https://www.intodeeplearning.com/example-markdown/",
            "relUrl": "/example-markdown/",
            "date": " • Jan 14, 2020"
        }
        
    
  

  
  

  

  
      ,"page2": {
          "title": "About Me",
          "content": "Hi! I created this site to document my learning in deep learning and research. Hope you can find something useful here! .",
          "url": "https://www.intodeeplearning.com/about/",
          "relUrl": "/about/",
          "date": ""
      }
      
  

  

  

  
  

  
  

  
  

  
  

  

  
  

  
      ,"page11": {
          "title": "",
          "content": "Sitemap: {{ “sitemap.xml” | absolute_url }} | .",
          "url": "https://www.intodeeplearning.com/robots.txt",
          "relUrl": "/robots.txt",
          "date": ""
      }
      
  

}